---
title: "data-wrangling"
author: "Maya Sollen-Norrlin"
date: "2022-08-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Loading libraries   
```{r}

library(tidyverse)

```



```{r}

chem_data <- read.csv("chemistry-data-raw.csv")

```

 

```{r}

str(chem_data)


```



```{r}

chem_data$NO3.as.N..mg.l. <- as.numeric(chem_data$NO3.as.N..mg.l.)

```



```{r}

chem_data$NO2.as.N...mg.l. <- as.numeric(chem_data$NO2.as.N...mg.l.)


```




```{r}


str(chem_data)



```



```{r}

chem_data <- chem_data %>% 
  rename(
    weeks = Time..weeks.,
  )
  

str(chem_data)
  
up_to7 <- filter(chem_data, weeks != 24)

str(up_to7)


head(up_to7, 20)

tail(up_to7, 20)

```




```{r}

complete.cases(up_to7)



```



```{r}


up_to7[!complete.cases(up_to7),]


```




Removing rows with NA's.
```{r}

up_to7 <- up_to7 %>%
  drop_na()

head(up_to7,20)

```


Checking that all NA's are gone.
```{r}


up_to7[!complete.cases(up_to7),]



```
Renaming columnsso they're easier to write in plot functions.
```{r}

up_to7 <- up_to7 %>% 
  rename(
   "NH4 (mg/l)" = NH4..mg.l.,
   "TON (mg/l)" = TON.as.N...mg.l.,
   "K (ppm)" = K..ppm.,
   "NO2 (mg/l)" = NO2.as.N...mg.l.,
   "NO3 (mg/l)" = NO3.as.N..mg.l.,
   "Conductivity (mV)" = conductivity..mV.
  )

head(up_to7)


```

Creating a "Fresh" category for the time stamp 0 samples (e.g. the control).
```{r}

up_to7$Treatment[up_to7$weeks == 0] <- "Fresh"

head(up_to7, 20)

```


```{r}


p <- ggplot(up_to7, aes(x = Treatment, y = `NH4 (mg/l)`, fill = as_factor(weeks))) +
  geom_boxplot(alpha = 0.5) +
  theme_bw(base_size = 15)

p


```


```{r}

chem_plots <- list()


for(i in 6:ncol(up_to7)){
  if (i > 12){break}
  chem_plots <- ggplot(up_to7, aes(x = Treatment, y = up_to7[,i], fill = as_factor(weeks))) +
          geom_boxplot(alpha = 0.5) +
          theme_bw(base_size = 15) +
          ylab(colnames(up_to7[i])) +
          labs(fill = "Time (weeks)")
  print((chem_plots))
  ggsave(chem_plots, filename = paste0("Box_", i, ".png"))
  
}


```



```{r}


pdf()

```



 
 
```{r}


print(chem_plots[pH])



```
 
 
```{r}





```
 
 
 
 
 